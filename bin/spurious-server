#!/usr/bin/env ruby

$: << File.join(File.dirname(__FILE__), '..', 'lib')

require 'spurious/server'
require "spurious/server/version"
require 'daemons'
require "eventmachine"

Docker.url = ENV.fetch('DOCKER_HOST', 'tcp://0.0.0.0:2375')
ip         = ENV.fetch('SPURIOUS_SERVER_IP', '0.0.0.0')
port       = ENV.fetch('SPURIOUS_SERVER_PORT', 4590)

Daemons.run_proc('Spurious Server', :dir => '/tmp', :log_output => true) do
  EventMachine.run Spurious::Server.handle(ip, port)
end
